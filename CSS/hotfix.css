/* =============== SIDEBAR / LOGO =============== */

/* Centraliza a marca no painel lateral e ajusta tipografia */
.sidebar .brand{
  justify-content: center !important;
}
.sidebar .logo{
  margin: 0 auto !important;
  text-align: center !important;
  font-size: 1.6rem !important;
  letter-spacing: .3px !important;
}
.sidebar .logo__gap{ width: 28px !important; } /* slot para futura logo */
.logo, .logo__left, .logo__right{ color: var(--primary) !important; } /* MOTO e ROTA mesma cor */


/* =============== NAV / BOT√ïES DO PAINEL =============== */

/* Bot√£o padr√£o: mais arredondado, respiro, profundidade base e transi√ß√µes flu√≠das */
.sidebar .nav .nav__item{
  border-radius: 14px !important;                 /* raio maior, conforme solicitado */
  margin: 0 .4rem !important;                     /* afasta das bordas da sidebar */
  padding: .9rem 1rem !important;
  background: var(--surface) !important;
  border: 1px solid var(--border) !important;
  color: #fff !important;
  display: flex !important;
  align-items: center !important;
  gap: .7rem !important;

  /* profundidade base (suave) */
  box-shadow: 0 3px 10px rgba(0,0,0,.16) !important;

  /* transi√ß√µes fluidas */
  transition:
    background-color .24s cubic-bezier(.22,.61,.36,1),
    border-color .24s cubic-bezier(.22,.61,.36,1),
    box-shadow .22s cubic-bezier(.22,.61,.36,1),
    transform .18s cubic-bezier(.22,.61,.36,1) !important;
}

/* Hover: leve eleva√ß√£o, borda destacada, fundo misturado e neon suave */
.sidebar .nav .nav__item:hover{
  transform: translateY(-1px) !important;
  border-color: color-mix(in oklab, var(--primary) 55%, var(--border)) !important;
  background: color-mix(in oklab, var(--surface) 80%, var(--primary) 20%) !important;

  /* neon suave + profundidade */
  box-shadow:
    0 10px 24px rgba(0,0,0,.28),
    0 0 6px color-mix(in oklab, var(--primary) 65%, transparent),
    0 0 14px color-mix(in oklab, var(--primary) 35%, transparent) !important;
}

/* Ativo: cor de marca, texto branco e glow contido */
.sidebar .nav .nav__item.is-active{
  background: var(--primary) !important;
  border-color: var(--primary) !important;
  color: #fff !important;
  box-shadow:
    0 8px 20px rgba(0,0,0,.26),
    0 0 8px color-mix(in oklab, var(--primary) 55%, transparent) !important;
}

/* √çcones sempre brancos (qualquer estado) */
.sidebar .nav .nav__item .nav__icon{
  color: #fff !important;
}

/* Foco acess√≠vel e elegante */
.sidebar .nav .nav__item:focus-visible{
  outline: 2px solid color-mix(in oklab, var(--primary) 80%, white) !important;
  outline-offset: 2px !important;
  box-shadow:
    0 0 0 3px color-mix(in oklab, var(--primary) 35%, transparent),
    0 6px 16px rgba(0,0,0,.22) !important;
}


/* =============== SWITCH DE TEMA (C√ÅPSULA + KNOB) =============== */

.theme-switch{
  width: 60px !important;
  height: 32px !important;
  border-radius: 999px !important;                 /* c√°psula bem arredondada */
  border: 1px solid var(--border) !important;
  background: color-mix(in oklab, var(--surface) 85%, var(--primary) 15%) !important;
  padding: 0 !important;
  position: relative !important;
  display: inline-block !important;
  transition: background-color .2s ease, border-color .2s ease !important;
}
.theme-switch__knob{
  position: absolute !important; top: 3px !important; left: 3px !important;
  width: 26px !important; height: 26px !important; border-radius: 50% !important;
  background: #fff !important; box-shadow: 0 1px 3px rgba(0,0,0,.25) !important;
  transition: transform .2s cubic-bezier(.22,.61,.36,1) !important;
}
/* knob √† direita quando claro */
[data-bs-theme="light"] .theme-switch__knob{
  transform: translateX(28px) !important;
}


/* =============== MAPA (LEAFLET) =============== */

/* Evita clipping acidental do container principal */
.main { overflow: visible !important; }

/* Container do mapa: altura real e posicionamento absoluto do canvas */
.map-wrap{
  position: relative !important;
  min-height: 480px !important;
  height: calc(100vh - 64px) !important;
}
#map.map{
  position: absolute !important;
  inset: 0 !important;
  width: 100% !important;
  height: 100% !important;
}

/* Modo debug (√∫ltima cartada se algo ainda zerar altura em CSS legado) */
html[data-debug-map="1"] #map.map { min-height: 480px !important; }

/* ===== MODO CLARO: texto/√≠cones pretos nos bot√µes N√ÉO selecionados ===== */
[data-bs-theme="light"] .sidebar .nav .nav__item:not(.is-active),
[data-bs-theme="light"] .sidebar .nav .nav__item:not(.is-active) .nav__label{
  color: #111 !important;                 /* texto preto */
}

[data-bs-theme="light"] .sidebar .nav .nav__item:not(.is-active) .nav__icon{
  color: #111 !important;                 /* √≠cone preto */
  filter: none !important;
}

/* Mant√©m o ATIVO (qualquer tema): fundo laranja + texto/√≠cones brancos */
.sidebar .nav .nav__item.is-active,
.sidebar .nav .nav__item.is-active .nav__label,
.sidebar .nav .nav__item.is-active .nav__icon{
  color: #fff !important;
}

/* (extra) Em hover no modo claro, continua preto para N√ÉO ativos */
[data-bs-theme="light"] .sidebar .nav .nav__item:not(.is-active):hover,
[data-bs-theme="light"] .sidebar .nav .nav__item:not(.is-active):hover .nav__label,
[data-bs-theme="light"] .sidebar .nav .nav__item:not(.is-active):hover .nav__icon{
  color: #111 !important;
}

/* ===== Topbar: layout de 3 colunas no DESKTOP ===== */
@media (min-width: 961px){
  .topbar{
    /* vira grid: [esquerda vazio] [busca] [direita (toggle+sauda√ß√£o)] */
    display: grid !important;
    grid-template-columns: 1fr minmax(320px, 480px) 1fr !important;
    align-items: center !important;
    gap: var(--space-3) !important;
  }

  /* bot√£o hamb√∫rguer s√≥ no mobile */
  #btnOpenSidebar{ display: none !important; }

  /* Busca sempre no centro */
  .topbar .search{
    grid-column: 2 !important;
    width: 100% !important;            /* ocupa a coluna central */
    justify-self: center !important;   /* garante centraliza√ß√£o */
    flex: 0 0 auto !important;         /* n√£o expande para as laterais */
  }

  /* Toggle de tema + sauda√ß√£o SEMPRE √† direita */
  .topbar .topbar__right{
    grid-column: 3 !important;
    justify-self: end !important;
    display: flex !important;
    align-items: center !important;
    gap: .5rem !important;
  }
}

/* ===== Mobile: busca 100% e bot√£o hamb√∫rguer vis√≠vel ===== */
@media (max-width: 960px){
  .topbar{
    display: flex !important;
    align-items: center !important;
    gap: var(--space-3) !important;
  }
  .topbar .search{ flex: 1 1 auto !important; }  /* ocupa largura dispon√≠vel */
  #btnOpenSidebar{ display: inline-grid !important; }
}

/* ===== STATUS SEMPRE ACIMA DO MAPA (stack fix) ===== */
.map-wrap{ position: relative !important; }

/* O mapa fica na base do empilhamento */
#map.map{
  position: absolute !important;
  inset: 0 !important;
  width: 100% !important;
  height: 100% !important;
  z-index: 0 !important;                 /* base */
}

/* O painel de status fica por cima do mapa e dos panes do Leaflet */
.status{
  position: absolute !important;
  top: 84px !important;
  right: 24px !important;
  width: 340px !important;
  max-width: calc(100vw - 48px) !important;
  z-index: 9999 !important;              /* MUITO acima */
  background: var(--surface) !important;
  color: var(--text) !important;
  border: 1px solid var(--border) !important;
  border-radius: var(--radius-lg) !important;
  box-shadow: 0 16px 38px rgba(0,0,0,.28) !important;
  overflow: hidden !important;
}

/* Em telas pequenas, volta a ser bloco normal */
@media (max-width: 960px){
  .status{
    position: static !important;
    z-index: auto !important;
    width: auto !important;
    margin: 12px !important;
  }
}

/* ===== FAB do Status (üì¶) ===== */
.fab.fab--status{
  right: 92px !important;            /* fica ao lado do chat */
  bottom: 24px !important;
  z-index: 10000 !important;
}

/* ===== Painel recolh√≠vel ===== */
.status{
  transform-origin: top right !important;
  transition: transform .22s cubic-bezier(.22,.61,.36,1),
             opacity .18s ease !important;
}
.status.is-collapsed{
  transform: scale(.96) translateY(-8px) !important;
  opacity: 0 !important;
  pointer-events: none !important;
}

/* ===== Legend como filtros ===== */
.status__legend{
  display: flex !important;
  flex-wrap: wrap !important;
  gap: .4rem !important;
  margin: .5rem var(--space-3) 0 var(--space-3) !important;
}
.status__legend .filter{
  border: 1px solid var(--border) !important;
  background: var(--surface) !important;
  color: var(--text) !important;
  border-radius: 999px !important;
  padding: .25rem .6rem !important;
  font-size: .8rem !important;
  transition: transform .12s ease, box-shadow .12s ease, background .12s ease !important;
}
.status__legend .filter:hover{ transform: translateY(-1px) !important; }
.status__legend .filter.is-active{
  box-shadow: 0 6px 14px rgba(0,0,0,.2) !important;
  border-color: color-mix(in oklab, var(--primary) 45%, var(--border)) !important;
  background: color-mix(in oklab, var(--surface) 80%, var(--primary) 20%) !important;
}

/* Cores dos chips por tipo */
.chip--danger{ background: color-mix(in oklab, var(--danger) 20%, var(--surface)) !important; }
.chip--ok    { background: color-mix(in oklab, var(--ok) 20%, var(--surface)) !important; }
.chip--warn  { background: color-mix(in oklab, var(--warn) 20%, var(--surface)) !important; }

/* ===== Cards com cor por status ===== */
.card{ color:#fff !important; border:1px solid transparent !important; }
.card--late{
  /* vermelho base (ser√° pulsado abaixo) */
  background: color-mix(in oklab, var(--danger) 85%, black) !important;
  animation: pulse-late 1.8s ease-in-out infinite !important;
}
.card--done{ background: var(--ok) !important; }
.card--on  { background: var(--warn) !important; color:#1b1b1b !important; }

/* Pulso para atrasadas: oscila claro/escuro suavemente */
@keyframes pulse-late{
  0%  { background: color-mix(in oklab, var(--danger) 70%, black); }
  50% { background: color-mix(in oklab, var(--danger) 92%, black); }
  100%{ background: color-mix(in oklab, var(--danger) 70%, black); }
}

/* Tema claro: legibilidade dos n√∫meros dentro dos chips */
[data-bs-theme="light"] .status__legend .filter b{ color: inherit !important; }

/* Bot√£o do status ao lado do chat */
.fab.fab--status{ right: 92px !important; bottom: 24px !important; z-index:10000 !important; }

/* Painel recolh√≠vel */
.status{
  transform-origin: top right !important;
  transition: transform .22s cubic-bezier(.22,.61,.36,1), opacity .18s ease !important;
  z-index: 9999 !important; /* acima do mapa */
}
.status.is-collapsed{
  transform: scale(.96) translateY(-8px) !important;
  opacity: 0 !important;
  pointer-events: none !important;
}
